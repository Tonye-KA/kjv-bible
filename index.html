<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KJV Holy Bible</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Georgia, serif; margin: 16px; }
h1 { text-align: center; margin-bottom: 8px; }
select { width: 100%; padding: 8px; margin-bottom: 8px; font-size: 16px; }
.verse { margin-bottom: 6px; }
.verse-number { font-size: 0.85em; vertical-align: super; margin-right: 6px; }
#errorMsg { color: red; text-align: center; margin-top: 16px; }
</style>
</head>
<body>

<h1>KJV Holy Bible</h1>

<select id="bookSelect"><option>Loading books...</option></select>
<select id="chapterSelect"><option>Choose chapter</option></select>

<div id="errorMsg"></div>
<div id="bibleText"></div>

<script>
const bookSelect = document.getElementById("bookSelect");
const chapterSelect = document.getElementById("chapterSelect");
const bibleText = document.getElementById("bibleText");
const errorMsg = document.getElementById("errorMsg");

// Load the list of books from Books.json
fetch("Books.json")
  .then(resp => resp.json())
  .then(books => {
    bookSelect.innerHTML = "";
    books.forEach(b => {
      const opt = document.createElement("option");
      opt.value = b;
      opt.textContent = b;
      bookSelect.appendChild(opt);
    });
    bookSelect.onchange = loadBook;
    loadBook(); // load first book on start
  })
  .catch(err => errorMsg.textContent = "Error loading Books.json: " + err.message);

// Load a book JSON
function loadBook() {
  const book = bookSelect.value;
  if (!book) return;
  fetch(book + ".json")
    .then(resp => resp.json())
    .then(data => {
      // data.chapters is an array of { chapter: X, verses: [ {verse, text}, ... ] }
      chapterSelect.innerHTML = "";
      data.chapters.forEach(chObj => {
        const opt = document.createElement("option");
        opt.value = chObj.chapter;
        opt.textContent = "Chapter " + chObj.chapter;
        chapterSelect.appendChild(opt);
      });
      chapterSelect.onchange = () => showChapter(data);
      showChapter(data); // show first chapter
    })
    .catch(err => {
      errorMsg.textContent = "Error loading book file: " + err.message;
      bibleText.innerHTML = "";
    });
}

// Display verses for selected chapter
function showChapter(bookData) {
  bibleText.innerHTML = "";
  const chosen = parseInt(chapterSelect.value);
  const chapterObj = bookData.chapters.find(c => c.chapter === chosen);
  if (!chapterObj) return;
  chapterObj.verses.forEach(v => {
    const div = document.createElement("div");
    div.className = "verse";
    div.innerHTML = `<span class="verse-number">${v.verse}</span>${v.text}`;
    bibleText.appendChild(div);
  });
}
</script>

</body>
</html>
